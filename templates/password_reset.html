{% extends "base.html" %}
{% block title %}Password Reset - Secure Digital Wallet{% endblock %}
{% block content %}
<h2>Password Reset (Certificate Required)</h2>
<div class="warning">
    <strong>Security Requirement:</strong> You must provide your X.509 certificate to reset your password.<br>
    This ensures only you can change your account password.
</div>

<form method="POST">
    {{ form.hidden_tag() }}
    <div>
        {{ form.username.label }}<br>
        {{ form.username(size=32, placeholder="Your username") }}
        {% if form.username.errors %}
            <div class="flash-error">
                {% for error in form.username.errors %}
                    {{ error }}
                {% endfor %}
            </div>
        {% endif %}
    </div>
    <div>
        {{ form.new_password.label }}<br>
        {{ form.new_password(size=32, placeholder="New password (at least 8 characters)") }}
        {% if form.new_password.errors %}
            <div class="flash-error">
                {% for error in form.new_password.errors %}
                    {{ error }}
                {% endfor %}
            </div>
        {% endif %}
    </div>
    <div>
        {{ form.certificate_pem.label }}<br>
        <textarea name="certificate_pem" rows="10" placeholder="Paste your X.509 certificate in PEM format">{{ form.certificate_pem.data }}</textarea>
        {% if form.certificate_pem.errors %}
            <div class="flash-error">
                {% for error in form.certificate_pem.errors %}
                    {{ error }}
                {% endfor %}
            </div>
        {% endif %}
    </div>
    <button type="submit">Reset Password</button>
</form>
<a href="{{ url_for('login') }}">‚Üê Back to Login</a>
{% endblock %}